1.1connect()、listen()和accept()三者之间的关系

在我之前的一篇博文中就有详细的提到过TCP的编程流程[TCP详解及编程流程](https://blog.csdn.net/qq_43412060/article/details/107115196 "TCP详解及编程流程")。在那篇博文中我们就详细提到了connect()、listen()和accept()这三个函数的使用。并且我们了解到了，`连接的建立是在listen()之后accept之前`。  
那么，具体的他们这三个函数内部的关系是怎样的呢？

**1、connect()函数分析**  
`【功能】`  
客户端主动连接服务器，建立连接是通过三次握手。

`【注意】`

-   这个连接的过程是内核完成的，不是这个函数完成的，这个函数的作用仅仅是通知给linux内核，让linux内核自动完成TCP三次握手连接
-   通常情况下，**客户端的connect（）函数会默认一直阻塞，直到三次握手成功或超市失败才返回**

**2、listen函数分析**  
`【功能】`  
将该套接字和套接字对应的连接队列长度告诉linux内核。因此，可以看出，只要TCP服务器调用了listen()，客户端就可以通过connect()和服务器建立连接，而这个连接的过程是内核完成的  
`【注意】`

-   listen()函数不会阻塞
-   在被动状态的socket有两个队列，一个是正在进行三次握手的socket队列，一个是完成三次握手的socket队列。在握手完成后会从正在握手队列移到握手完成的队列，此时已经建立连接。

**3、accept()函数分析**  
`【功能】`  
**从连接队列头部取出一个已经完成的连接，**如果这个队列没有已经完成的连接，accept()函数就会阻塞，直到取出队列中已完成的用户连接为止。